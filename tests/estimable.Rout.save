
R : Copyright 2003, The R Development Core Team
Version 1.7.0  (2003-04-16)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type `license()' or `licence()' for distribution details.

R is a collaborative project with many contributors.
Type `contributors()' for more information.

Type `demo()' for some demos, `help()' for on-line help, or
`help.start()' for a HTML browser interface to help.
Type `q()' to quit R.

> library(gregmisc)
Loading required package: MASS 

Attaching package 'gregmisc':


	The following object(s) are masked from package:base :

	 lowess 

> set.seed(1234567,"default")
> y <- rnorm(100)
> x <-  cut(rnorm(100, mean=y, sd=0.25),c(-4,-1.5,0,1.5,4))
> reg <- lm(y ~ x)
> summary(reg)

Call:
lm(formula = y ~ x)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.08402 -0.31026  0.02173  0.30216  1.43750 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -1.8653     0.1671 -11.166  < 2e-16 ***
x(-1.5,0]     1.3012     0.1813   7.177  1.5e-10 ***
x(0,1.5]      2.4424     0.1823  13.399  < 2e-16 ***
x(1.5,4]      3.5380     0.2694  13.134  < 2e-16 ***
---
Signif. codes:  0 `***' 0.001 `**' 0.01 `*' 0.05 `.' 0.1 ` ' 1 

Residual standard error: 0.4725 on 96 degrees of freedom
Multiple R-Squared: 0.7644,	Adjusted R-squared: 0.757 
F-statistic: 103.8 on 3 and 96 DF,  p-value: < 2.2e-16 

> 
> # look at the group means
> gm <- sapply(split(y,x),mean)
> gm
 (-4,-1.5]   (-1.5,0]    (0,1.5]    (1.5,4] 
-1.8653458 -0.5641708  0.5770224  1.6726344 
> 
> 
> # contrast mean of 2nd group vs mean of 4th group
> estimable(reg, c(    0,   1,    0,   -1) )
            Estimate Std. Error   t value DF     Pr(>|t|)
(0 1 0 -1) -2.236805  0.2227427 -10.04210 96 2.220446e-16
> # estimate should be equal to:
> gm[2] - gm[4]
 (-1.5,0] 
-2.236805 
> 
> # confidence intervals etc. for the line for level 4
> # for a separate continuous variable modelled as spline
> # with a single knot at 0.5:
> x2 <- rnorm(100,mean=y,sd=0.5)
> reg2 <- lm(y ~ x + x2 + pmax(x2-0.5,0) )
> 
> xx2<-seq(-2,2,,50)
> tmp <- estimable(reg2,cbind(1,0,0,1,xx2,pmax(xx2-0.5,0)), conf.int=0.95)
> tmp
                                                 Estimate Std. Error    t value
(1 0 0 1 -2 0)                                 0.06430189  0.2488798  0.2583653
(1 0 0 1 -1.91836734693878 0)                  0.08852477  0.2462282  0.3595234
(1 0 0 1 -1.83673469387755 0)                  0.11274765  0.2436604  0.4627246
(1 0 0 1 -1.75510204081633 0)                  0.13697053  0.2411791  0.5679204
(1 0 0 1 -1.67346938775510 0)                  0.16119342  0.2387871  0.6750507
(1 0 0 1 -1.59183673469388 0)                  0.18541630  0.2364871  0.7840441
(1 0 0 1 -1.51020408163265 0)                  0.20963918  0.2342817  0.8948168
(1 0 0 1 -1.42857142857143 0)                  0.23386206  0.2321736  1.0072723
(1 0 0 1 -1.34693877551020 0)                  0.25808494  0.2301656  1.1213011
(1 0 0 1 -1.26530612244898 0)                  0.28230782  0.2282602  1.2367805
(1 0 0 1 -1.18367346938776 0)                  0.30653070  0.2264601  1.3535746
(1 0 0 1 -1.10204081632653 0)                  0.33075358  0.2247678  1.4715343
(1 0 0 1 -1.02040816326531 0)                  0.35497646  0.2231858  1.5904977
(1 0 0 1 -0.938775510204082 0)                 0.37919934  0.2217163  1.7102907
(1 0 0 1 -0.857142857142857 0)                 0.40342222  0.2203617  1.8307276
(1 0 0 1 -0.775510204081633 0)                 0.42764510  0.2191241  1.9516118
(1 0 0 1 -0.693877551020408 0)                 0.45186798  0.2180054  2.0727376
(1 0 0 1 -0.612244897959184 0)                 0.47609086  0.2170076  2.1938907
(1 0 0 1 -0.530612244897959 0)                 0.50031374  0.2161322  2.3148505
(1 0 0 1 -0.448979591836735 0)                 0.52453662  0.2153808  2.4353914
(1 0 0 1 -0.36734693877551 0)                  0.54875950  0.2147547  2.5552847
(1 0 0 1 -0.285714285714286 0)                 0.57298238  0.2142550  2.6743007
(1 0 0 1 -0.204081632653061 0)                 0.59720526  0.2138826  2.7922108
(1 0 0 1 -0.122448979591837 0)                 0.62142814  0.2136381  2.9087892
(1 0 0 1 -0.0408163265306123 0)                0.64565102  0.2135219  3.0238158
(1 0 0 1 0.0408163265306123 0)                 0.66987390  0.2135344  3.1370774
(1 0 0 1 0.122448979591836 0)                  0.69409678  0.2136754  3.2483703
(1 0 0 1 0.204081632653061 0)                  0.71831966  0.2139447  3.3575016
(1 0 0 1 0.285714285714286 0)                  0.74254254  0.2143418  3.4642914
(1 0 0 1 0.36734693877551 0)                   0.76676542  0.2148661  3.5685738
(1 0 0 1 0.448979591836734 0)                  0.79098830  0.2155165  3.6701984
(1 0 0 1 0.530612244897959 0.0306122448979589) 0.82560474  0.2138131  3.8613384
(1 0 0 1 0.612244897959183 0.112244897959183)  0.87754380  0.2081556  4.2158066
(1 0 0 1 0.693877551020408 0.193877551020408)  0.92948286  0.2027128  4.5852197
(1 0 0 1 0.775510204081633 0.275510204081633)  0.98142191  0.1975025  4.9691618
(1 0 0 1 0.857142857142857 0.357142857142857)  1.03336097  0.1925435  5.3668958
(1 0 0 1 0.938775510204081 0.438775510204081)  1.08530002  0.1878558  5.7773052
(1 0 0 1 1.02040816326531 0.520408163265306)   1.13723908  0.1834600  6.1988386
(1 0 0 1 1.10204081632653 0.60204081632653)    1.18917813  0.1793778  6.6294613
(1 0 0 1 1.18367346938775 0.683673469387755)   1.24111719  0.1756309  7.0666211
(1 0 0 1 1.26530612244898 0.76530612244898)    1.29305625  0.1722413  7.5072368
(1 0 0 1 1.34693877551020 0.846938775510204)   1.34499530  0.1692304  7.9477171
(1 0 0 1 1.42857142857143 0.928571428571428)   1.39693436  0.1666187  8.3840172
(1 0 0 1 1.51020408163265 1.01020408163265)    1.44887341  0.1644254  8.8117398
(1 0 0 1 1.59183673469388 1.09183673469388)    1.50081247  0.1626672  9.2262781
(1 0 0 1 1.67346938775510 1.17346938775510)    1.55275152  0.1613584  9.6229984
(1 0 0 1 1.75510204081633 1.25510204081633)    1.60469058  0.1605100  9.9974471
(1 0 0 1 1.83673469387755 1.33673469387755)    1.65662964  0.1601294 10.3455675
(1 0 0 1 1.91836734693878 1.41836734693878)    1.70856869  0.1602199 10.6639012
(1 0 0 1 2 1.5)                                1.76050775  0.1607806 10.9497545
                                               DF     Pr(>|t|)    Lower CI
(1 0 0 1 -2 0)                                 94 7.966899e-01 -0.42985479
(1 0 0 1 -1.91836734693878 0)                  94 7.200100e-01 -0.40036700
(1 0 0 1 -1.83673469387755 0)                  94 6.446312e-01 -0.37104572
(1 0 0 1 -1.75510204081633 0)                  94 5.714431e-01 -0.34189627
(1 0 0 1 -1.67346938775510 0)                  94 5.013006e-01 -0.31292401
(1 0 0 1 -1.59183673469388 0)                  94 4.349855e-01 -0.28413431
(1 0 0 1 -1.51020408163265 0)                  94 3.731706e-01 -0.25553256
(1 0 0 1 -1.42857142857143 0)                  94 3.163898e-01 -0.22712409
(1 0 0 1 -1.34693877551020 0)                  94 2.650161e-01 -0.19891424
(1 0 0 1 -1.26530612244898 0)                  94 2.192497e-01 -0.17090824
(1 0 0 1 -1.18367346938776 0)                  94 1.791180e-01 -0.14311122
(1 0 0 1 -1.10204081632653 0)                  94 1.444867e-01 -0.11552823
(1 0 0 1 -1.02040816326531 0)                  94 1.150804e-01 -0.08816412
(1 0 0 1 -0.938775510204082 0)                 94 9.051087e-02 -0.06102358
(1 0 0 1 -0.857142857142857 0)                 94 7.030959e-02 -0.03411108
(1 0 0 1 -0.775510204081633 0)                 94 5.396096e-02 -0.00743085
(1 0 0 1 -0.693877551020408 0)                 94 4.093384e-02  0.01901315
(1 0 0 1 -0.612244897959184 0)                 94 3.070851e-02  0.04521727
(1 0 0 1 -0.530612244897959 0)                 94 2.279777e-02  0.07117819
(1 0 0 1 -0.448979591836735 0)                 94 1.676152e-02  0.09689294
(1 0 0 1 -0.36734693877551 0)                  94 1.221504e-02  0.12235893
(1 0 0 1 -0.285714285714286 0)                 94 8.831797e-03  0.14757400
(1 0 0 1 -0.204081632653061 0)                 94 6.341937e-03  0.17253637
(1 0 0 1 -0.122448979591837 0)                 94 4.527812e-03  0.19724473
(1 0 0 1 -0.0408163265306123 0)                94 3.217703e-03  0.22169820
(1 0 0 1 0.0408163265306123 0)                 94 2.278809e-03  0.24589637
(1 0 0 1 0.122448979591836 0)                  94 1.610263e-03  0.26983929
(1 0 0 1 0.204081632653061 0)                  94 1.136679e-03  0.29352745
(1 0 0 1 0.285714285714286 0)                  94 8.025117e-04  0.31696182
(1 0 0 1 0.36734693877551 0)                   94 5.673454e-04  0.34014380
(1 0 0 1 0.448979591836734 0)                  94 4.020867e-04  0.36307524
(1 0 0 1 0.530612244897959 0.0306122448979589) 94 2.069644e-04  0.40107381
(1 0 0 1 0.612244897959183 0.112244897959183)  94 5.719343e-05  0.46424595
(1 0 0 1 0.693877551020408 0.193877551020408)  94 1.395871e-05  0.52699178
(1 0 0 1 0.775510204081633 0.275510204081633)  94 3.009179e-06  0.58927606
(1 0 0 1 0.857142857142857 0.357142857142857)  94 5.747711e-07  0.65106131
(1 0 0 1 0.938775510204081 0.438775510204081)  94 9.790322e-08  0.71230802
(1 0 0 1 1.02040816326531 0.520408163265306)   94 1.502361e-08  0.77297490
(1 0 0 1 1.10204081632653 0.60204081632653)    94 2.106348e-09  0.83301932
(1 0 0 1 1.18367346938775 0.683673469387755)   94 2.746876e-10  0.89239787
(1 0 0 1 1.26530612244898 0.76530612244898)    94 3.404366e-11  0.95106710
(1 0 0 1 1.34693877551020 0.846938775510204)   94 4.109602e-12  1.00898439
(1 0 0 1 1.42857142857143 0.928571428571428)   94 4.962697e-13  1.06610895
(1 0 0 1 1.51020408163265 1.01020408163265)    94 6.172840e-14  1.12240302
(1 0 0 1 1.59183673469388 1.09183673469388)    94 8.215650e-15  1.17783301
(1 0 0 1 1.67346938775510 1.17346938775510)    94 1.110223e-15  1.23237066
(1 0 0 1 1.75510204081633 1.25510204081633)    94 2.220446e-16  1.28599414
(1 0 0 1 1.83673469387755 1.33673469387755)    94 0.000000e+00  1.33868894
(1 0 0 1 1.91836734693878 1.41836734693878)    94 0.000000e+00  1.39044842
(1 0 0 1 2 1.5)                                94 0.000000e+00  1.44127416
                                                Upper CI
(1 0 0 1 -2 0)                                 0.5584586
(1 0 0 1 -1.91836734693878 0)                  0.5774166
(1 0 0 1 -1.83673469387755 0)                  0.5965410
(1 0 0 1 -1.75510204081633 0)                  0.6158373
(1 0 0 1 -1.67346938775510 0)                  0.6353108
(1 0 0 1 -1.59183673469388 0)                  0.6549669
(1 0 0 1 -1.51020408163265 0)                  0.6748109
(1 0 0 1 -1.42857142857143 0)                  0.6948482
(1 0 0 1 -1.34693877551020 0)                  0.7150841
(1 0 0 1 -1.26530612244898 0)                  0.7355239
(1 0 0 1 -1.18367346938776 0)                  0.7561726
(1 0 0 1 -1.10204081632653 0)                  0.7770354
(1 0 0 1 -1.02040816326531 0)                  0.7981170
(1 0 0 1 -0.938775510204082 0)                 0.8194222
(1 0 0 1 -0.857142857142857 0)                 0.8409555
(1 0 0 1 -0.775510204081633 0)                 0.8627210
(1 0 0 1 -0.693877551020408 0)                 0.8847228
(1 0 0 1 -0.612244897959184 0)                 0.9069644
(1 0 0 1 -0.530612244897959 0)                 0.9294493
(1 0 0 1 -0.448979591836735 0)                 0.9521803
(1 0 0 1 -0.36734693877551 0)                  0.9751601
(1 0 0 1 -0.285714285714286 0)                 0.9983908
(1 0 0 1 -0.204081632653061 0)                 1.0218741
(1 0 0 1 -0.122448979591837 0)                 1.0456115
(1 0 0 1 -0.0408163265306123 0)                1.0696038
(1 0 0 1 0.0408163265306123 0)                 1.0938514
(1 0 0 1 0.122448979591836 0)                  1.1183543
(1 0 0 1 0.204081632653061 0)                  1.1431119
(1 0 0 1 0.285714285714286 0)                  1.1681233
(1 0 0 1 0.36734693877551 0)                   1.1933870
(1 0 0 1 0.448979591836734 0)                  1.2189014
(1 0 0 1 0.530612244897959 0.0306122448979589) 1.2501357
(1 0 0 1 0.612244897959183 0.112244897959183)  1.2908417
(1 0 0 1 0.693877551020408 0.193877551020408)  1.3319739
(1 0 0 1 0.775510204081633 0.275510204081633)  1.3735678
(1 0 0 1 0.857142857142857 0.357142857142857)  1.4156606
(1 0 0 1 0.938775510204081 0.438775510204081)  1.4582920
(1 0 0 1 1.02040816326531 0.520408163265306)   1.5015033
(1 0 0 1 1.10204081632653 0.60204081632653)    1.5453369
(1 0 0 1 1.18367346938775 0.683673469387755)   1.5898365
(1 0 0 1 1.26530612244898 0.76530612244898)    1.6350454
(1 0 0 1 1.34693877551020 0.846938775510204)   1.6810062
(1 0 0 1 1.42857142857143 0.928571428571428)   1.7277598
(1 0 0 1 1.51020408163265 1.01020408163265)    1.7753438
(1 0 0 1 1.59183673469388 1.09183673469388)    1.8237919
(1 0 0 1 1.67346938775510 1.17346938775510)    1.8731324
(1 0 0 1 1.75510204081633 1.25510204081633)    1.9233870
(1 0 0 1 1.83673469387755 1.33673469387755)    1.9745703
(1 0 0 1 1.91836734693878 1.41836734693878)    2.0266890
(1 0 0 1 2 1.5)                                2.0797413
> 
> 
> 
