
R : Copyright 2002, The R Development Core Team
Version 1.5.1 Patched (2002-06-18)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type `license()' or `licence()' for distribution details.

R is a collaborative project with many contributors.
Type `contributors()' for more information.

Type `demo()' for some demos, `help()' for on-line help, or
`help.start()' for a HTML browser interface to help.
Type `q()' to quit R.

> library(gregmisc)
Loading required package: MASS 

Attaching package `gregmisc':


	The following object(s) are masked from package:base :

	 lowess plot.lm 

> set.seed(1234567,"default")
> y <- rnorm(100)
> x <-  cut(rnorm(100, mean=y, sd=0.25),c(-4,-1.5,0,1.5,4))
> reg <- lm(y ~ x)
> summary(reg)

Call:
lm(formula = y ~ x)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.05284 -0.47822 -0.06119  0.43047  1.34368 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -1.7688     0.1867  -9.476 1.99e-15 ***
x(-1.5,0]     1.0789     0.2033   5.307 7.15e-07 ***
x(0,1.5]      2.3666     0.2041  11.597  < 2e-16 ***
x(1.5,4]      3.5841     0.2640  13.577  < 2e-16 ***
---
Signif. codes:  0 `***' 0.001 `**' 0.01 `*' 0.05 `.' 0.1 ` ' 1 

Residual standard error: 0.528 on 96 degrees of freedom
Multiple R-Squared: 0.7633,	Adjusted R-squared: 0.7559 
F-statistic: 103.2 on 3 and 96 DF,  p-value: < 2.2e-16 

> 
> # look at the group means
> gm <- sapply(split(y,x),mean)
> gm
 (-4,-1.5]   (-1.5,0]    (0,1.5]    (1.5,4] 
-1.7687935 -0.6898513  0.5978277  1.8152775 
> 
> 
> # contrast mean of 2nd group vs mean of 4th group
> estimable(reg, c(    0,   1,    0,   -1) )
            Estimate Std. Error   t value DF Pr(>|t|)
(0 1 0 -1) -2.505129  0.2032928 -12.32276 96        0
> # estimate should be equal to:
> gm[2] - gm[4]
 (-1.5,0] 
-2.505129 
> 
> # confidence intervals etc. for the line for level 4
> # for a separate continuous variable modelled as spline
> # with a single knot at 0.5:
> x2 <- rnorm(100,mean=y,sd=0.5)
> reg2 <- lm(y ~ x + x2 + pmax(x2-0.5,0) )
> 
> xx2<-seq(-2,2,,50)
> tmp <- estimable(reg2,cbind(1,0,0,1,xx2,pmax(xx2-0.5,0)), conf.int=0.95)
> tmp
                                                   Estimate Std. Error
(1 0 0 1 -2 0)                                 -0.245778183  0.2200033
(1 0 0 1 -1.91836734693878 0)                  -0.204345878  0.2175377
(1 0 0 1 -1.83673469387755 0)                  -0.162913573  0.2151446
(1 0 0 1 -1.75510204081633 0)                  -0.121481268  0.2128265
(1 0 0 1 -1.67346938775510 0)                  -0.080048962  0.2105860
(1 0 0 1 -1.59183673469388 0)                  -0.038616657  0.2084254
(1 0 0 1 -1.51020408163265 0)                   0.002815648  0.2063474
(1 0 0 1 -1.42857142857143 0)                   0.044247953  0.2043545
(1 0 0 1 -1.34693877551020 0)                   0.085680258  0.2024491
(1 0 0 1 -1.26530612244898 0)                   0.127112563  0.2006338
(1 0 0 1 -1.18367346938776 0)                   0.168544869  0.1989110
(1 0 0 1 -1.10204081632653 0)                   0.209977174  0.1972831
(1 0 0 1 -1.02040816326531 0)                   0.251409479  0.1957525
(1 0 0 1 -0.938775510204082 0)                  0.292841784  0.1943216
(1 0 0 1 -0.857142857142857 0)                  0.334274089  0.1929925
(1 0 0 1 -0.775510204081633 0)                  0.375706394  0.1917673
(1 0 0 1 -0.693877551020408 0)                  0.417138700  0.1906481
(1 0 0 1 -0.612244897959184 0)                  0.458571005  0.1896367
(1 0 0 1 -0.530612244897959 0)                  0.500003310  0.1887349
(1 0 0 1 -0.448979591836735 0)                  0.541435615  0.1879442
(1 0 0 1 -0.36734693877551 0)                   0.582867920  0.1872660
(1 0 0 1 -0.285714285714286 0)                  0.624300225  0.1867016
(1 0 0 1 -0.204081632653061 0)                  0.665732531  0.1862521
(1 0 0 1 -0.122448979591837 0)                  0.707164836  0.1859181
(1 0 0 1 -0.0408163265306123 0)                 0.748597141  0.1857004
(1 0 0 1 0.0408163265306123 0)                  0.790029446  0.1855994
(1 0 0 1 0.122448979591836 0)                   0.831461751  0.1856153
(1 0 0 1 0.204081632653061 0)                   0.872894056  0.1857480
(1 0 0 1 0.285714285714286 0)                   0.914326362  0.1859972
(1 0 0 1 0.36734693877551 0)                    0.955758667  0.1863626
(1 0 0 1 0.448979591836734 0)                   0.997190972  0.1868434
(1 0 0 1 0.530612244897959 0.0306122448979589)  1.041414809  0.1847190
(1 0 0 1 0.612244897959183 0.112244897959183)   1.090291197  0.1782248
(1 0 0 1 0.693877551020408 0.193877551020408)   1.139167586  0.1719325
(1 0 0 1 0.775510204081633 0.275510204081633)   1.188043975  0.1658650
(1 0 0 1 0.857142857142857 0.357142857142857)   1.236920364  0.1600480
(1 0 0 1 0.938775510204081 0.438775510204081)   1.285796753  0.1545096
(1 0 0 1 1.02040816326531 0.520408163265306)    1.334673142  0.1492810
(1 0 0 1 1.10204081632653 0.60204081632653)     1.383549531  0.1443957
(1 0 0 1 1.18367346938775 0.683673469387755)    1.432425920  0.1398897
(1 0 0 1 1.26530612244898 0.76530612244898)     1.481302309  0.1358009
(1 0 0 1 1.34693877551020 0.846938775510204)    1.530178698  0.1321679
(1 0 0 1 1.42857142857143 0.928571428571428)    1.579055087  0.1290293
(1 0 0 1 1.51020408163265 1.01020408163265)     1.627931475  0.1264218
(1 0 0 1 1.59183673469388 1.09183673469388)     1.676807864  0.1243789
(1 0 0 1 1.67346938775510 1.17346938775510)     1.725684253  0.1229287
(1 0 0 1 1.75510204081633 1.25510204081633)     1.774560642  0.1220924
(1 0 0 1 1.83673469387755 1.33673469387755)     1.823437031  0.1218825
(1 0 0 1 1.91836734693878 1.41836734693878)     1.872313420  0.1223024
(1 0 0 1 2 1.5)                                 1.921189809  0.1233455
                                                   t value DF     Pr(>|t|)
(1 0 0 1 -2 0)                                 -1.11715660 94 2.667747e-01
(1 0 0 1 -1.91836734693878 0)                  -0.93935867 94 3.499542e-01
(1 0 0 1 -1.83673469387755 0)                  -0.75722844 94 4.508070e-01
(1 0 0 1 -1.75510204081633 0)                  -0.57079956 94 5.694976e-01
(1 0 0 1 -1.67346938775510 0)                  -0.38012490 94 7.047103e-01
(1 0 0 1 -1.59183673469388 0)                  -0.18527805 94 8.534101e-01
(1 0 0 1 -1.51020408163265 0)                   0.01364518 94 9.891420e-01
(1 0 0 1 -1.42857142857143 0)                   0.21652548 94 8.290474e-01
(1 0 0 1 -1.34693877551020 0)                   0.42321876 94 6.731024e-01
(1 0 0 1 -1.26530612244898 0)                   0.63355518 94 5.279097e-01
(1 0 0 1 -1.18367346938776 0)                   0.84733827 94 3.989589e-01
(1 0 0 1 -1.10204081632653 0)                   1.06434449 94 2.898991e-01
(1 0 0 1 -1.02040816326531 0)                   1.28432294 94 2.021853e-01
(1 0 0 1 -0.938775510204082 0)                  1.50699554 94 1.351652e-01
(1 0 0 1 -0.857142857142857 0)                  1.73205752 94 8.654352e-02
(1 0 0 1 -0.775510204081633 0)                  1.95917842 94 5.305482e-02
(1 0 0 1 -0.693877551020408 0)                  2.18800342 94 3.114832e-02
(1 0 0 1 -0.612244897959184 0)                  2.41815525 94 1.752657e-02
(1 0 0 1 -0.530612244897959 0)                  2.64923644 94 9.463997e-03
(1 0 0 1 -0.448979591836735 0)                  2.88083207 94 4.913058e-03
(1 0 0 1 -0.36734693877551 0)                   3.11251293 94 2.457647e-03
(1 0 0 1 -0.285714285714286 0)                  3.34383901 94 1.187833e-03
(1 0 0 1 -0.204081632653061 0)                  3.57436333 94 5.564186e-04
(1 0 0 1 -0.122448979591837 0)                  3.80363597 94 2.534771e-04
(1 0 0 1 -0.0408163265306123 0)                 4.03120834 94 1.127083e-04
(1 0 0 1 0.0408163265306123 0)                  4.25663741 94 4.910453e-05
(1 0 0 1 0.122448979591836 0)                   4.47949000 94 2.104521e-05
(1 0 0 1 0.204081632653061 0)                   4.69934691 94 8.908162e-06
(1 0 0 1 0.285714285714286 0)                   4.91580686 94 3.738986e-06
(1 0 0 1 0.36734693877551 0)                    5.12849013 94 1.562225e-06
(1 0 0 1 0.448979591836734 0)                   5.33704183 94 6.522180e-07
(1 0 0 1 0.530612244897959 0.0306122448979589)  5.63783182 94 1.798279e-07
(1 0 0 1 0.612244897959183 0.112244897959183)   6.11750394 94 2.165665e-08
(1 0 0 1 0.693877551020408 0.193877551020408)   6.62566646 94 2.143550e-09
(1 0 0 1 0.775510204081633 0.275510204081633)   7.16271441 94 1.746809e-10
(1 0 0 1 0.857142857142857 0.357142857142857)   7.72843466 94 1.180811e-11
(1 0 0 1 0.938775510204081 0.438775510204081)   8.32179143 94 6.716849e-13
(1 0 0 1 1.02040816326531 0.520408163265306)    8.94067901 94 3.286260e-14
(1 0 0 1 1.10204081632653 0.60204081632653)     9.58165474 94 1.332268e-15
(1 0 0 1 1.18367346938775 0.683673469387755)   10.23967795 94 0.000000e+00
(1 0 0 1 1.26530612244898 0.76530612244898)    10.90789581 94 0.000000e+00
(1 0 0 1 1.34693877551020 0.846938775510204)   11.57753377 94 0.000000e+00
(1 0 0 1 1.42857142857143 0.928571428571428)   12.23795911 94 0.000000e+00
(1 0 0 1 1.51020408163265 1.01020408163265)    12.87698405 94 0.000000e+00
(1 0 0 1 1.59183673469388 1.09183673469388)    13.48145081 94 0.000000e+00
(1 0 0 1 1.67346938775510 1.17346938775510)    14.03809030 94 0.000000e+00
(1 0 0 1 1.75510204081633 1.25510204081633)    14.53457458 94 0.000000e+00
(1 0 0 1 1.83673469387755 1.33673469387755)    14.96061163 94 0.000000e+00
(1 0 0 1 1.91836734693878 1.41836734693878)    15.30888796 94 0.000000e+00
(1 0 0 1 2 1.5)                                15.57567569 94 0.000000e+00
                                                   Lower CI  Upper CI
(1 0 0 1 -2 0)                                 -0.682599973 0.1910436
(1 0 0 1 -1.91836734693878 0)                  -0.636271984 0.2275802
(1 0 0 1 -1.83673469387755 0)                  -0.590088125 0.2642610
(1 0 0 1 -1.75510204081633 0)                  -0.544053258 0.3010907
(1 0 0 1 -1.67346938775510 0)                  -0.498172304 0.3380744
(1 0 0 1 -1.59183673469388 0)                  -0.452450226 0.3752169
(1 0 0 1 -1.51020408163265 0)                  -0.406892015 0.4125233
(1 0 0 1 -1.42857142857143 0)                  -0.361502670 0.4499986
(1 0 0 1 -1.34693877551020 0)                  -0.316287177 0.4876477
(1 0 0 1 -1.26530612244898 0)                  -0.271250490 0.5254756
(1 0 0 1 -1.18367346938776 0)                  -0.226397505 0.5634872
(1 0 0 1 -1.10204081632653 0)                  -0.181733033 0.6016874
(1 0 0 1 -1.02040816326531 0)                  -0.137261779 0.6400807
(1 0 0 1 -0.938775510204082 0)                 -0.092988308 0.6786719
(1 0 0 1 -0.857142857142857 0)                 -0.048917018 0.7174652
(1 0 0 1 -0.775510204081633 0)                 -0.005052115 0.7564649
(1 0 0 1 -0.693877551020408 0)                  0.038602424 0.7956750
(1 0 0 1 -0.612244897959184 0)                  0.082042872 0.8350991
(1 0 0 1 -0.530612244897959 0)                  0.125265790 0.8747408
(1 0 0 1 -0.448979591836735 0)                  0.168268044 0.9146032
(1 0 0 1 -0.36734693877551 0)                   0.211046840 0.9546890
(1 0 0 1 -0.285714285714286 0)                  0.253599744 0.9950007
(1 0 0 1 -0.204081632653061 0)                  0.295924701 1.0355404
(1 0 0 1 -0.122448979591837 0)                  0.338020057 1.0763096
(1 0 0 1 -0.0408163265306123 0)                 0.379884575 1.1173097
(1 0 0 1 0.0408163265306123 0)                  0.421517442 1.1585415
(1 0 0 1 0.122448979591836 0)                   0.462918279 1.2000052
(1 0 0 1 0.204081632653061 0)                   0.504087147 1.2417010
(1 0 0 1 0.285714285714286 0)                   0.545024541 1.2836282
(1 0 0 1 0.36734693877551 0)                    0.585731390 1.3257859
(1 0 0 1 0.448979591836734 0)                   0.626209047 1.3681729
(1 0 0 1 0.530612244897959 0.0306122448979589)  0.674650850 1.4081788
(1 0 0 1 0.612244897959183 0.112244897959183)   0.736421588 1.4441608
(1 0 0 1 0.693877551020408 0.193877551020408)   0.797791521 1.4805437
(1 0 0 1 0.775510204081633 0.275510204081633)   0.858715033 1.5173729
(1 0 0 1 0.857142857142857 0.357142857142857)   0.919141346 1.5546994
(1 0 0 1 0.938775510204081 0.438775510204081)   0.979014299 1.5925792
(1 0 0 1 1.02040816326531 0.520408163265306)    1.038272297 1.6310740
(1 0 0 1 1.10204081632653 0.60204081632653)     1.096848528 1.6702505
(1 0 0 1 1.18367346938775 0.683673469387755)    1.154671555 1.7101803
(1 0 0 1 1.26530612244898 0.76530612244898)     1.211666394 1.7509382
(1 0 0 1 1.34693877551020 0.846938775510204)    1.267756170 1.7926012
(1 0 0 1 1.42857142857143 0.928571428571428)    1.322864421 1.8352458
(1 0 0 1 1.51020408163265 1.01020408163265)     1.376918032 1.8789449
(1 0 0 1 1.59183673469388 1.09183673469388)     1.429850666 1.9237651
(1 0 0 1 1.67346938775510 1.17346938775510)     1.481606429 1.9697621
(1 0 0 1 1.75510204081633 1.25510204081633)     1.532143381 2.0169779
(1 0 0 1 1.83673469387755 1.33673469387755)     1.581436433 2.0654376
(1 0 0 1 1.91836734693878 1.41836734693878)     1.629479179 2.1151477
(1 0 0 1 2 1.5)                                 1.676284389 2.1660952
> 
> 
> 
