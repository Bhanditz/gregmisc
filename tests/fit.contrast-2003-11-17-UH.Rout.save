
R : Copyright 2003, The R Development Core Team
Version 1.8.0  (2003-10-08)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> # This code tests for incorrect handling of glm objects, as reported
> # by Ulrich Halekoh, Phd <ulrich.halekoh@agrsci.dk>
> 
> library(gregmisc)

Attaching package 'gregmisc':


	The following object(s) are masked from package:base :

	 lowess 

> set.seed(7882)
> 
> x<-rep(c(0,1),c(20,20))
> z<-2+0.4*x
> p<-plogis(z)
> event<-rbinom(length(p),50,p)
> y<-cbind(event,50-event)
> xf<-factor(x)
> g<-glm(y~xf,family=binomial)
> 
> 
> f1<-fit.contrast(g,xf,c(-1,1))
> 
> print('fit.contrast')
[1] "fit.contrast"
> print(f1)
              Estimate Std. Error  z value     Pr(>|z|)
xf c=( -1 1 )  0.64339  0.1500948 4.286557 1.814634e-05
> print('summary of glm')
[1] "summary of glm"
> print(summary(g)$coef['xf1',])
    Estimate   Std. Error      z value     Pr(>|z|) 
6.433900e-01 1.500948e-01 4.286557e+00 1.814634e-05 
> print ('estimable')
[1] "estimable"
> print(estimable(g,c(0,1)))
      Estimate Std. Error  t value DF     Pr(>|t|)
(0 1)  0.64339  0.1500948 4.286557 38 0.0001195999
> print('ci')
[1] "ci"
> print(ci(g))
            Estimate CI lower  CI upper Std. Error      p-value
(Intercept) 1.840434 1.654255 2.0266122 0.09196749 4.347789e-89
xf1         0.643390 0.339539 0.9472411 0.15009482 1.814634e-05
> 
> 
