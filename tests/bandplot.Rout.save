
R : Copyright 2002, The R Development Core Team
Version 1.6.0  (2002-10-01)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type `license()' or `licence()' for distribution details.

R is a collaborative project with many contributors.
Type `contributors()' for more information.

Type `demo()' for some demos, `help()' for on-line help, or
`help.start()' for a HTML browser interface to help.
Type `q()' to quit R.

> library(gregmisc)
Loading required package: MASS 

Attaching package `gregmisc':


	The following object(s) are masked from package:base :

	 lowess 

> set.seed(123547,"default")
> # fixed mean, changing variance
> x <- 1:1000
> y <- rnorm(1000, mean=1, sd=1 + x/1000 )
> bandplot(x,y)
> 
> # fixed varance, changing mean
> x <- 1:1000
> y <- rnorm(1000, mean=x/1000, sd=1)
> bandplot(x,y)
> 
> #
> # changing mean and variance
> #
> x <- abs(rnorm(500))
> y <- rnorm(500, mean=2*x, sd=2+2*x)
> 
> # the changing mean and dispersion are hard to see whith the points alone:
> plot(x,y )
> 
> # regression picks up the mean trend, but not the change in variance
> reg <- lm(y~x)
> summary(reg)

Call:
lm(formula = y ~ x)

Residuals:
       Min         1Q     Median         3Q        Max 
-13.489382  -2.365885   0.003018   2.373472  13.060476 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.06564    0.28240   0.232    0.816    
x            2.32290    0.30464   7.625 1.25e-13 ***
---
Signif. codes:  0 `***' 0.001 `**' 0.01 `*' 0.05 `.' 0.1 ` ' 1 

Residual standard error: 3.759 on 498 degrees of freedom
Multiple R-Squared: 0.1045,	Adjusted R-squared: 0.1027 
F-statistic: 58.14 on 1 and 498 DF,  p-value: 1.245e-13 

> 
> # using bandplot on the original data helps to show the mean and
> # variance trend
> bandplot(x,y)
> 
> plot(x,y)
> bandplot(x,y,add=T)
> 
> # using bandplot on the residuals helps to see that regression removes
> # the mean trend but leaves the trend in variability
> bandplot(predict(reg),resid(reg))
> 
> 
