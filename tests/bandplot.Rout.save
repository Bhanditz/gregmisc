
R : Copyright 2004, The R Foundation for Statistical Computing
Version 1.9.0 beta (2004-03-26), ISBN 3-900051-00-3

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> library(gregmisc)

Attaching package 'gregmisc':


	The following object(s) are masked from package:stats :

	 lowess 

> set.seed(123547,"default")
> # fixed mean, changing variance
> x <- 1:1000
> y <- rnorm(1000, mean=1, sd=1 + x/1000 )
> bandplot(x,y)
> 
> # fixed varance, changing mean
> x <- 1:1000
> y <- rnorm(1000, mean=x/1000, sd=1)
> bandplot(x,y)
> 
> #
> # changing mean and variance
> #
> x <- abs(rnorm(500))
> y <- rnorm(500, mean=2*x, sd=2+2*x)
> 
> # the changing mean and dispersion are hard to see whith the points alone:
> plot(x,y )
> 
> # regression picks up the mean trend, but not the change in variance
> reg <- lm(y~x)
> summary(reg)

Call:
lm(formula = y ~ x)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.2045  -2.0570   0.1239   2.2041  17.1635 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -0.1377     0.2878  -0.479    0.632    
x             2.2598     0.2885   7.834 2.88e-14 ***
---
Signif. codes:  0 `***' 0.001 `**' 0.01 `*' 0.05 `.' 0.1 ` ' 1 

Residual standard error: 3.938 on 498 degrees of freedom
Multiple R-Squared: 0.1097,	Adjusted R-squared: 0.1079 
F-statistic: 61.37 on 1 and 498 DF,  p-value: 2.883e-14 

> 
> # using bandplot on the original data helps to show the mean and
> # variance trend
> bandplot(x,y)
> 
> plot(x,y)
> bandplot(x,y,add=T)
> 
> # using bandplot on the residuals helps to see that regression removes
> # the mean trend but leaves the trend in variability
> bandplot(predict(reg),resid(reg))
> 
> 
