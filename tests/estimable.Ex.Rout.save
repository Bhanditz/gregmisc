
R : Copyright 2004, The R Foundation for Statistical Computing
Version 1.9.0 beta (2004-03-26), ISBN 3-900051-00-3

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> library(gregmisc)

Attaching package 'gregmisc':


	The following object(s) are masked from package:stats :

	 lowess 

> set.seed(1234)
> 
> # simple contrast and confidence interval
> y <- rnorm(100)
> x <-  cut(rnorm(100, mean=y, sd=0.25),c(-4,-1.5,0,1.5,4))
> reg <- lm(y ~ x)
> estimable(reg, c(    0,   1,    0,   -1) )
            Estimate Std. Error   t value DF Pr(>|t|)
(0 1 0 -1) -2.706706   0.184736 -14.65175 96        0
> 
> # Fit a spline with a single knot at 0.5 and plot the *pointwise*
> # confidence intervals
> x2 <- rnorm(100,mean=y,sd=0.5)
> reg2 <- lm(y ~ x + x2 + pmax(x2-0.5,0) )
> range <- seq(-2,2,,50)
> tmp <- estimable(reg2,cbind(1,0,0,1,range,pmax(range-0.5,0)), conf.int=0.95)
> plotCI(x=range,y=tmp[,1],li=tmp[,6],ui=tmp[,7])
> 
> # Fit both linear and quasi-Poisson models to iris data, then compute
> # conficence intervals on a contrast.
> data(iris)
> lm1  <- lm(Sepal.Length~Sepal.Width+Species+Sepal.Width:Species, data=iris)
> glm1 <- glm(Sepal.Length~Sepal.Width+Species+Sepal.Width:Species, data=iris,
+             family=quasipoisson("identity"))
> cm <- rbind( lambda1 = c(1,0,1,0,0,0),
+              lambda2 = c(1,0,0,1,0,0))
> estimable(lm1,cm)
        Estimate Std. Error  t value  DF     Pr(>|t|)
lambda1 3.539735  0.5580189 6.343396 144 2.735194e-09
lambda2 3.906836  0.5826525 6.705260 144 4.247154e-10
> estimable(glm1,cm)
        Estimate Std. Error  t value  DF     Pr(>|t|)
lambda1 3.549904  0.5422795 6.546263 144 9.688996e-10
lambda2 3.921773  0.6056852 6.474937 144 1.398190e-09
> 
