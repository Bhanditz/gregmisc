
R : Copyright 2002, The R Development Core Team
Version 1.6.0  (2002-10-01)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type `license()' or `licence()' for distribution details.

R is a collaborative project with many contributors.
Type `contributors()' for more information.

Type `demo()' for some demos, `help()' for on-line help, or
`help.start()' for a HTML browser interface to help.
Type `q()' to quit R.

> library(gregmisc)
Loading required package: MASS 

Attaching package `gregmisc':


	The following object(s) are masked from package:base :

	 lowess 

> 
> set.seed(123456789,"default")
> x <- rdirichlet(20, c(1,1,1))
> x
             [,1]       [,2]       [,3]
 [1,] 0.543049798 0.35660769 0.10034251
 [2,] 0.334062772 0.36332040 0.30261683
 [3,] 0.285313902 0.13970250 0.57498360
 [4,] 0.513950463 0.35672804 0.12932150
 [5,] 0.226307520 0.13259449 0.64109799
 [6,] 0.048012377 0.84962273 0.10236489
 [7,] 0.505326998 0.29595103 0.19872197
 [8,] 0.265926763 0.24669651 0.48737673
 [9,] 0.365809367 0.47292179 0.16126885
[10,] 0.599342721 0.03009464 0.37056264
[11,] 0.653448135 0.13815874 0.20839313
[12,] 0.005513344 0.51792984 0.47655682
[13,] 0.470572261 0.17072077 0.35870697
[14,] 0.218813895 0.75167190 0.02951420
[15,] 0.533907826 0.38012859 0.08596358
[16,] 0.383181361 0.30341501 0.31340363
[17,] 0.290286870 0.11249553 0.59721760
[18,] 0.279723477 0.22847518 0.49180134
[19,] 0.725805607 0.19284393 0.08135047
[20,] 0.634416044 0.01614153 0.34944243
> if(!all.equal(apply(x,1,sum),rep(1,nrow(x)))) stop("Dirichlet generated random deviate that didn't sum to 1")
> tmp.1 <- ddirichlet(x, alpha=c(1,2,3))
> tmp.1
 [1] 0.21543284 1.99630632 2.77119020 0.35795626 3.26983288 0.53416992
 [7] 0.70123388 3.51595923 0.73797479 0.24794977 0.35999494 7.05751087
[13] 1.31800555 0.03928635 0.16854303 1.78811873 2.40741911 3.31565778
[19] 0.07657329 0.11826255
> tmp.2 <- ddirichlet(x, alpha=matrix(c(1,2,3),nrow=20,ncol=3,byrow=TRUE))
> if(!all.equal(tmp.1,tmp.2))
+   stop("Something wrong in ddirichlet.  Equivalent computations produced different results.")
> tmp.2
 [1] 0.21543284 1.99630632 2.77119020 0.35795626 3.26983288 0.53416992
 [7] 0.70123388 3.51595923 0.73797479 0.24794977 0.35999494 7.05751087
[13] 1.31800555 0.03928635 0.16854303 1.78811873 2.40741911 3.31565778
[19] 0.07657329 0.11826255
> 
> x <- rdirichlet(20, c(0.25,1,17))
> x
              [,1]        [,2]      [,3]
 [1,] 4.036545e-04 0.014078164 0.9855182
 [2,] 6.838334e-03 0.027047794 0.9661139
 [3,] 3.456309e-03 0.046633000 0.9499107
 [4,] 2.236389e-03 0.010240225 0.9875234
 [5,] 1.619617e-03 0.093008035 0.9053723
 [6,] 4.445605e-03 0.008128741 0.9874257
 [7,] 1.445715e-02 0.131959425 0.8535834
 [8,] 1.569364e-04 0.046102334 0.9537407
 [9,] 3.119531e-03 0.141045806 0.8558347
[10,] 2.925879e-02 0.050404666 0.9203365
[11,] 4.727835e-05 0.012925474 0.9870272
[12,] 1.702907e-03 0.041876259 0.9564208
[13,] 6.550090e-02 0.061042142 0.8734570
[14,] 6.136422e-02 0.073964763 0.8646710
[15,] 2.866349e-05 0.018562667 0.9814087
[16,] 4.423382e-02 0.030534874 0.9252313
[17,] 9.515315e-02 0.128351371 0.7764955
[18,] 6.310427e-02 0.025856286 0.9110394
[19,] 9.848462e-03 0.034116107 0.9560354
[20,] 4.631653e-12 0.038797564 0.9612024
> if(!all.equal(apply(x,1,sum),rep(1,nrow(x)))) stop("Dirichlet generated random deviate that didn't sum to 1")
> ddirichlet(x, c(0.25,1,17) )
 [1] 2.671411e+03 2.327309e+02 2.961957e+02 7.642079e+02 2.425438e+02
 [6] 4.557599e+02 1.830152e+01 3.211487e+03 6.029549e+01 3.598058e+01
[11] 1.367361e+04 5.618300e+02 8.517114e+00 7.608374e+00 1.816415e+04
[16] 2.872784e+01 9.795334e-01 1.718560e+01 1.496826e+02 1.615658e+09
> 
> 
> 
> x <- rdirichlet(20, c(0.25,1,1.7,0.15))
> x
              [,1]       [,2]      [,3]         [,4]
 [1,] 1.182466e-01 0.37761463 0.4059137 9.822505e-02
 [2,] 3.814339e-01 0.01725698 0.3049941 2.963151e-01
 [3,] 2.786344e-02 0.69677598 0.2159528 5.940782e-02
 [4,] 6.798083e-02 0.01331805 0.8624664 5.623471e-02
 [5,] 5.611687e-02 0.21551682 0.7044181 2.394821e-02
 [6,] 4.357930e-01 0.35770793 0.1964905 1.000853e-02
 [7,] 2.675144e-01 0.10699919 0.5888187 3.666772e-02
 [8,] 8.922810e-02 0.37716736 0.5336045 4.996426e-08
 [9,] 1.719274e-02 0.46466698 0.4439925 7.414779e-02
[10,] 7.781379e-02 0.23250372 0.1497575 5.399250e-01
[11,] 1.772647e-04 0.18107532 0.7417569 7.699052e-02
[12,] 1.943919e-02 0.16333949 0.8051890 1.203229e-02
[13,] 1.762302e-08 0.47290128 0.5266934 4.053150e-04
[14,] 4.094753e-02 0.08855391 0.8702195 2.790961e-04
[15,] 7.354930e-04 0.52784451 0.4372186 3.420139e-02
[16,] 1.270479e-04 0.50010659 0.4863241 1.344225e-02
[17,] 5.045721e-06 0.04835700 0.9207540 3.088396e-02
[18,] 2.294400e-05 0.09937574 0.9006012 1.351765e-07
[19,] 5.991049e-03 0.53694541 0.4564599 6.036511e-04
[20,] 1.753739e-05 0.46970527 0.5302770 1.713918e-07
> if(!all.equal(apply(x,1,sum),rep(1,nrow(x)))) stop("Dirichlet generated random deviate that didn't sum to 1")
> ddirichlet(x, c(0.25,1,1.7,0.15) )
 [1] 2.033733e+00 2.705950e-01 5.927600e+00 8.386810e+00 1.736401e+01
 [6] 3.205789e+00 3.305265e+00 6.802801e+05 1.167997e+01 3.253622e-01
[11] 5.007439e+02 7.580446e+01 3.421980e+07 1.122147e+03 2.371313e+02
[16] 2.108832e+03 1.827283e+04 2.073842e+08 1.567319e+03 1.431059e+08
> 
> 
