
R : Copyright 2003, The R Development Core Team
Version 1.7.0  (2003-04-16)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type `license()' or `licence()' for distribution details.

R is a collaborative project with many contributors.
Type `contributors()' for more information.

Type `demo()' for some demos, `help()' for on-line help, or
`help.start()' for a HTML browser interface to help.
Type `q()' to quit R.

> library(gregmisc)
Loading required package: MASS 

Attaching package 'gregmisc':


	The following object(s) are masked from package:base :

	 lowess 

> 
> set.seed(123456789,"default")
> x <- rdirichlet(20, c(1,1,1))
> x
            [,1]       [,2]       [,3]
 [1,] 0.24607056 0.21891267 0.53501677
 [2,] 0.10546694 0.37055996 0.52397310
 [3,] 0.05527591 0.73193616 0.21278793
 [4,] 0.58769950 0.13907932 0.27322119
 [5,] 0.17505896 0.49337868 0.33156236
 [6,] 0.27876490 0.17024060 0.55099450
 [7,] 0.58762130 0.11940841 0.29297029
 [8,] 0.22784560 0.42290345 0.34925095
 [9,] 0.14783711 0.44050047 0.41166243
[10,] 0.16805046 0.60351562 0.22843392
[11,] 0.17760216 0.15620506 0.66619278
[12,] 0.60956516 0.13394855 0.25648629
[13,] 0.10438736 0.08950633 0.80610631
[14,] 0.05447627 0.26116900 0.68435473
[15,] 0.20555769 0.24744408 0.54699823
[16,] 0.44590379 0.06781391 0.48628230
[17,] 0.88248036 0.09800348 0.01951616
[18,] 0.47620794 0.44140032 0.08239174
[19,] 0.12045056 0.16533650 0.71421294
[20,] 0.51815047 0.43614825 0.04570127
> if(!all.equal(apply(x,1,sum),rep(1,nrow(x)))) stop("Dirichlet generated random deviate that didn't sum to 1")
> tmp.1 <- ddirichlet(x, alpha=c(1,2,3))
> tmp.1
 [1] 3.759732353 6.104185514 1.988467123 0.622934731 3.254333686 3.101051042
 [7] 0.614940838 3.095050078 4.478989924 1.889561216 4.159548476 0.528710084
[13] 3.489712521 7.338975328 4.442221058 0.962159232 0.002239656 0.179784073
[19] 5.060290180 0.054656524
> tmp.2 <- ddirichlet(x, alpha=matrix(c(1,2,3),nrow=20,ncol=3,byrow=TRUE))
> if(!all.equal(tmp.1,tmp.2))
+   stop("Something wrong in ddirichlet.  Equivalent computations produced different results.")
> tmp.2
 [1] 3.759732353 6.104185514 1.988467123 0.622934731 3.254333686 3.101051042
 [7] 0.614940838 3.095050078 4.478989924 1.889561216 4.159548476 0.528710084
[13] 3.489712521 7.338975328 4.442221058 0.962159232 0.002239656 0.179784073
[19] 5.060290180 0.054656524
> 
> x <- rdirichlet(20, c(0.25,1,17))
> x
              [,1]        [,2]      [,3]
 [1,] 9.780597e-05 0.004568823 0.9953334
 [2,] 1.824382e-06 0.036653554 0.9633446
 [3,] 6.351828e-03 0.083353983 0.9102942
 [4,] 2.146574e-04 0.038723733 0.9610616
 [5,] 4.147431e-04 0.038912968 0.9606723
 [6,] 1.092852e-04 0.005878600 0.9940121
 [7,] 1.906576e-02 0.112933873 0.8680004
 [8,] 2.330985e-05 0.012953089 0.9870236
 [9,] 6.217894e-04 0.102062697 0.8973155
[10,] 2.955950e-03 0.032230891 0.9648132
[11,] 2.747851e-02 0.028330963 0.9441905
[12,] 2.439304e-03 0.004346285 0.9932144
[13,] 8.476203e-03 0.057477981 0.9340458
[14,] 4.162939e-03 0.084772485 0.9110646
[15,] 2.255465e-02 0.003549372 0.9738960
[16,] 7.604129e-04 0.043575895 0.9556637
[17,] 6.920786e-05 0.084191479 0.9157393
[18,] 3.327961e-03 0.058367123 0.9383049
[19,] 1.942715e-03 0.027099554 0.9709577
[20,] 2.218503e-05 0.014663016 0.9853148
> if(!all.equal(apply(x,1,sum),rep(1,nrow(x)))) stop("Dirichlet generated random deviate that didn't sum to 1")
> ddirichlet(x, c(0.25,1,17) )
 [1]   9064.35294 106483.86043     94.91788   2869.61796   1739.73718
 [6]   8165.06591     19.44204  23238.05727    431.02664    427.25035
[11]     56.79670    784.96914    115.43929    132.08402    108.11549
[16]   1015.56575   3096.32803    250.31335    647.90618  23456.80357
> 
> 
> 
> x <- rdirichlet(20, c(0.25,1,1.7,0.15))
> x
              [,1]       [,2]      [,3]         [,4]
 [1,] 0.1546636932 0.32959073 0.5155319 2.136533e-04
 [2,] 0.0004543319 0.06201287 0.9259838 1.154900e-02
 [3,] 0.0910736040 0.01303446 0.7870842 1.088077e-01
 [4,] 0.0001444320 0.69587404 0.3039789 2.588990e-06
 [5,] 0.0071264022 0.33888031 0.6509581 3.035235e-03
 [6,] 0.0503855106 0.06243422 0.3557752 5.314051e-01
 [7,] 0.0004022549 0.16543518 0.7137590 1.204036e-01
 [8,] 0.0007267498 0.43478607 0.5644872 1.499149e-09
 [9,] 0.0007841355 0.14699671 0.8522191 8.318754e-09
[10,] 0.0001526858 0.06436356 0.3876945 5.477892e-01
[11,] 0.2396443889 0.09814449 0.6621418 6.933221e-05
[12,] 0.2260720492 0.12577971 0.6029401 4.520812e-02
[13,] 0.0450903124 0.63620339 0.1745183 1.441880e-01
[14,] 0.0026603901 0.38489328 0.2853740 3.270723e-01
[15,] 0.0006270174 0.57867202 0.2840612 1.366397e-01
[16,] 0.0579131674 0.11939458 0.4359864 3.867059e-01
[17,] 0.0155854793 0.22518761 0.7589546 2.723496e-04
[18,] 0.0089817778 0.24208408 0.6505843 9.834987e-02
[19,] 0.0056908918 0.12154325 0.8727620 3.866607e-06
[20,] 0.1736832284 0.48598774 0.3390920 1.237054e-03
> if(!all.equal(apply(x,1,sum),rep(1,nrow(x)))) stop("Dirichlet generated random deviate that didn't sum to 1")
> ddirichlet(x, c(0.25,1,1.7,0.15) )
 [1] 3.602926e+02 1.448107e+03 3.604796e+00 1.983595e+06 4.470353e+02
 [6] 8.372455e-01 1.802758e+02 5.140695e+08 1.509781e+08 6.708776e+01
[11] 8.045747e+02 3.191124e+00 1.674971e+00 9.840219e+00 6.089184e+01
[16] 1.139319e+00 2.148444e+03 1.953457e+01 1.876645e+05 5.536618e+01
> 
> 
