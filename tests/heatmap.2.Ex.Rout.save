
R : Copyright 2004, The R Foundation for Statistical Computing
Version 1.9.0 beta (2004-03-26), ISBN 3-900051-00-3

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> library(gregmisc)

Attaching package 'gregmisc':


	The following object(s) are masked from package:stats :

	 lowess 

> set.seed(1234)
> 
>  data(mtcars)
>  x  <- as.matrix(mtcars)
>  rc <- rainbow(nrow(x), start=0, end=.3)
>  cc <- rainbow(ncol(x), start=0, end=.3)
>  hv <- heatmap.2(x, col = cm.colors(256), scale="column",
+ 	       RowSideColors = rc, ColSideColors = cc, margin=c(5,10),
+ 	       xlab = "specification variables", ylab= "Car Models",
+ 	       main = "heatmap(<Mtcars data>, ..., scale = \"column\")",
+                tracecol="green", density="density")
> 
>  str(hv) # the two re-ordering index vectors
List of 2
 $ rowInd: int [1:32] 31 17 16 15 5 25 29 24 7 6 ...
 $ colInd: int [1:11] 2 9 8 11 6 5 10 7 1 4 ...
> 
>  data(attitude)
>  round(Ca <- cor(attitude), 2)
           rating complaints privileges learning raises critical advance
rating       1.00       0.83       0.43     0.62   0.59     0.16    0.16
complaints   0.83       1.00       0.56     0.60   0.67     0.19    0.22
privileges   0.43       0.56       1.00     0.49   0.45     0.15    0.34
learning     0.62       0.60       0.49     1.00   0.64     0.12    0.53
raises       0.59       0.67       0.45     0.64   1.00     0.38    0.57
critical     0.16       0.19       0.15     0.12   0.38     1.00    0.28
advance      0.16       0.22       0.34     0.53   0.57     0.28    1.00
>  symnum(Ca) # simple graphic
           rt cm p l rs cr a
rating     1                
complaints +  1             
privileges .  .  1          
learning   ,  .  . 1        
raises     .  ,  . , 1      
critical             .  1   
advance          . . .     1
attr(,"legend")
[1] 0 ` ' 0.3 `.' 0.6 `,' 0.8 `+' 0.9 `*' 0.95 `B' 1
> 
>  # with reorder
>  heatmap.2(Ca,		 symm = TRUE, margin=c(6,6), trace="none" )
> 
>  # without reorder
>  heatmap.2(Ca, Rowv=FALSE, symm = TRUE, margin=c(6,6), trace="none" )
> 
>  ## For variable clustering, rather use distance based on cor():
>  data(USJudgeRatings)
>  symnum( cU <- cor(USJudgeRatings) )
     CO I DM DI CF DE PR F O W PH R
CONT 1                             
INTG    1                          
DMNR    B 1                        
DILG    + +  1                     
CFMG    + +  B  1                  
DECI    + +  B  B  1               
PREP    + +  B  B  B  1            
FAMI    + +  B  *  *  B  1         
ORAL    * *  B  B  *  B  B 1       
WRIT    * +  B  *  *  B  B B 1     
PHYS    , ,  +  +  +  +  + + + 1   
RTEN    * *  *  *  *  B  * B B *  1
attr(,"legend")
[1] 0 ` ' 0.3 `.' 0.6 `,' 0.8 `+' 0.9 `*' 0.95 `B' 1
> 
>  hU <- heatmap.2(cU, Rowv = FALSE, symm = TRUE, col = topo.colors(16),
+               distfun = function(c) as.dist(1 - c), trace="none")
> 
>  ## The Correlation matrix with same reordering:
>  hM <- format(round(cU[hU[[1]], hU[[2]]],2))
>  hM
     CONT    INTG    DMNR    PHYS    DILG    CFMG    DECI    RTEN    ORAL   
CONT " 1.00" "-0.13" "-0.15" " 0.05" " 0.01" " 0.14" " 0.09" "-0.03" "-0.01"
INTG "-0.13" " 1.00" " 0.96" " 0.74" " 0.87" " 0.81" " 0.80" " 0.94" " 0.91"
DMNR "-0.15" " 0.96" " 1.00" " 0.79" " 0.84" " 0.81" " 0.80" " 0.94" " 0.91"
PHYS " 0.05" " 0.74" " 0.79" " 1.00" " 0.81" " 0.88" " 0.87" " 0.91" " 0.89"
DILG " 0.01" " 0.87" " 0.84" " 0.81" " 1.00" " 0.96" " 0.96" " 0.93" " 0.95"
CFMG " 0.14" " 0.81" " 0.81" " 0.88" " 0.96" " 1.00" " 0.98" " 0.93" " 0.95"
DECI " 0.09" " 0.80" " 0.80" " 0.87" " 0.96" " 0.98" " 1.00" " 0.92" " 0.95"
RTEN "-0.03" " 0.94" " 0.94" " 0.91" " 0.93" " 0.93" " 0.92" " 1.00" " 0.98"
ORAL "-0.01" " 0.91" " 0.91" " 0.89" " 0.95" " 0.95" " 0.95" " 0.98" " 1.00"
WRIT "-0.04" " 0.91" " 0.89" " 0.86" " 0.96" " 0.94" " 0.95" " 0.97" " 0.99"
PREP " 0.01" " 0.88" " 0.86" " 0.85" " 0.98" " 0.96" " 0.96" " 0.95" " 0.98"
FAMI "-0.03" " 0.87" " 0.84" " 0.84" " 0.96" " 0.94" " 0.94" " 0.94" " 0.98"
     WRIT    PREP    FAMI   
CONT "-0.04" " 0.01" "-0.03"
INTG " 0.91" " 0.88" " 0.87"
DMNR " 0.89" " 0.86" " 0.84"
PHYS " 0.86" " 0.85" " 0.84"
DILG " 0.96" " 0.98" " 0.96"
CFMG " 0.94" " 0.96" " 0.94"
DECI " 0.95" " 0.96" " 0.94"
RTEN " 0.97" " 0.95" " 0.94"
ORAL " 0.99" " 0.98" " 0.98"
WRIT " 1.00" " 0.99" " 0.99"
PREP " 0.99" " 1.00" " 0.99"
FAMI " 0.99" " 0.99" " 1.00"
> 
>  # now with the correlation matrix on the plot itself
> 
>  heatmap.2(cU, Rowv = FALSE, symm = TRUE, col = rev(heat.colors(16)),
+              distfun = function(c) as.dist(1 - c), trace="none",
+              cellnote=hM)
> 
> 
> 
