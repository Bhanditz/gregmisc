
R : Copyright 2004, The R Foundation for Statistical Computing
Version 1.9.0 beta (2004-03-26), ISBN 3-900051-00-3

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> library(gregmisc)

Attaching package 'gregmisc':


	The following object(s) are masked from package:stats :

	 lowess 

> set.seed(1234)
> 
> 
> #show local mean and inner 2-sd interval to help diagnose changing mean
> #or variance structure
> x <- 1:1000
> y <- rnorm(1000, mean=1, sd=1 + x/1000 )
> 
> plot(x,y)
> lines(wapply(x,y,mean),col="red")
> 
> CL <- function(x,sd) mean(x)+sd*sqrt(var(x))
> 
> lines(wapply(x,y,CL,sd= 1),col="blue") 
> lines(wapply(x,y,CL,sd=-1),col="blue") 
> lines(wapply(x,y,CL,sd= 2),col="green")
> lines(wapply(x,y,CL,sd=-2),col="green")
> 
> #show local mean and inner 2-sd interval to help diagnose changing mean
> #or variance structure
> x <- 1:1000
> y <- rnorm(1000, mean=x/1000, sd=1)
> 
> plot(x,y)
> lines(wapply(x,y,mean),col="red")
> 
> CL <- function(x,sd) mean(x)+sd*sqrt(var(x))
> 
> lines(wapply(x,y,CL,sd= 1,method="fraction",width=1/20),col="blue")
> lines(wapply(x,y,CL,sd=-1,method="fraction",width=1/20),col="blue")
> lines(wapply(x,y,CL,sd= 2,method="nobs",width=250),col="green")
> lines(wapply(x,y,CL,sd=-2,method="nobs",width=250),col="green")
> 
> 
> 
